const API = import.meta.env.VITE_API_URL || 'http://localhost:4000'; async function req(path, opts={}){ const token = localStorage.getItem('token'); const headers = Object.assign({'content-type':'application/json'}, opts.headers||{}); if(token) headers['authorization']=`Bearer ${token}`; const res = await fetch(API+path, Object.assign({headers}, opts)); const text = await res.text(); try{return JSON.parse(text)}catch(e){return text} } export const login = (u,p)=>req('/api/auth/login',{method:'POST',body:JSON.stringify({username:u,password:p})}); export const register = (payload)=>req('/api/auth/register',{method:'POST',body:JSON.stringify(payload)}); export const getPosts = ()=>req('/api/posts'); export const createPost = (payload)=>req('/api/posts',{method:'POST',body:JSON.stringify(payload)}); export default {login,register,getPosts,createPost};