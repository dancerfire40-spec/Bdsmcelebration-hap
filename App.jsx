import React, {useEffect,useState} from 'react'; import { AuthProvider, useAuth } from './auth'; import * as api from './api'; function Header({onRoute}){ const {user,logout}=useAuth(); return (<div className='header'><div style={{fontWeight:700}}>Community</div><div>{user?<> <span style={{marginRight:10}}>Hi, {user.username}</span><button className='btn' onClick={logout}>Sign out</button></>:<button className='btn' onClick={()=>onRoute('login')}>Sign in</button>}</div></div>); } function Home(){ const [posts,setPosts]=useState([]); useEffect(()=>{api.getPosts().then(setPosts).catch(()=>setPosts([]))},[]); return (<div className='container'><div style={{marginTop:16}} className='card'><h2>Latest posts</h2><div style={{marginTop:12,display:'grid',gap:8}}>{posts.map(p=> <div key={p.id} className='card'><strong>{p.title}</strong><div style={{color:'#6b7280'}}>{p.body}</div></div>)}</div></div></div>); } function Login({onRoute}){ const {login} = useAuth(); const [u,setU]=useState(''); const [p,setP]=useState(''); async function submit(e){ e.preventDefault(); try{ await login(u,p); onRoute('home') }catch(e){ alert('Login failed') } } return (<div className='container'><form onSubmit={submit} className='card'><h3>Sign in</h3><input value={u} onChange={e=>setU(e.target.value)} placeholder='username'/><input type='password' value={p} onChange={e=>setP(e.target.value)} placeholder='password'/><div style={{marginTop:8}}><button className='btn'>Sign in</button></div></form></div>); } function AppInner(){ const [route,setRoute]=useState('home'); function nav(r){setRoute(r)} return (<><Header onRoute={nav}/>{route==='home'&&<Home/>}{route==='login'&&<Login onRoute={nav}/>}</>);} export default function App(){ return <AuthProvider><AppInner/></AuthProvider> }